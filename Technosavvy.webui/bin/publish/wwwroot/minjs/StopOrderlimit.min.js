var rn = 5; function PlaceStopLimitBuyOrder() { if (ValidateStopLimitBuy()) { $("#slbTotal").val(); var t = BuildStopLimitBuyOrderPackage(); $.ajax({ type: "POST", url: "/Order/StopLimitOrderBuy", beforeSend: function (t) { t.setRequestHeader("RequestVerificationToken", $('input:hidden[name="__RequestVerificationToken"]').val()) }, data: t, success: function (t) { "true" == t.item1 ? (StopLimitBuyRest(), TupleMsg(t, !0)) : TupleEr(t, !0) }, error: function (t) { console.log(t.statusCode + ":" + t.statusText + ":" + t.responseText) } }), $(this).parent(".input-btn-css").addClass("inputDisabled") } } function ValidateStopLimitBuy() { var t = !1; +$("#slbStopPrice").val() <= 0 && ($("#slbStopPriceV").text("Invalid Trigger Price"), $("#slbStopPriceV").removeClass("d-none"), t = !0); var l = $("#slbAmount").val(), e = $("#nquoteavailable").val(); +l <= 0 ? ($("#slbAmountV").text("Invalid Amount"), $("#slbAmountV").removeClass("d-none"), t = !0) : $("#slbAmountV").addClass("d-none"), $("#slbPrice").val() <= 0 ? ($("#slbPriceV").text("Invalid Price"), $("#slbPriceV").removeClass("d-none"), t = !0) : $("#slbPriceV").addClass("d-none"); var s = $("#slbTotal").val(); return s <= 0 || +s > +e ? ($("#slbTotalV").text("Insufficent/Invalid Total"), $("#slbTotalV").removeClass("d-none"), t = !0) : $("#slbTotalV").addClass("d-none"), !t } var mcode = "", bcode = "", qcode = ""; function BuildStopLimitBuyOrderPackage() { var t = $("#slbAmount").val(), l = $("#slbPrice").val(), e = $("#slbStopPrice").val(); return +l > 0 ? { Amount: t, Price: l, side: 0, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, stopPrice: e, OrderId: "?" } : { Amount: t, Price: 0, side: 0, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, stopPrice: e, OrderId: "?" } } function StopLimitBuyRest() { $("#slbStopPrice").val(""), $("#slbPrice").val(""), $("#slbAmount").val(""), $("#slbTotal").val(""), $("#slbTechnoSavvyV").val(""), $("#slbSTV").val(""), $("#slbassamt").val(""), $("#slbStopPriceV").addClass("d-none"), $("#slbPriceV").addClass("d-none"), $("#slbAmountV").addClass("d-none"), $("#slbTotalV").addClass("d-none") } function StopLimitBuyUpdate1() { "" == $("#slbPrice").val() && $("#slbPrice").val(lastPrice), p = $("#slbPrice").val(), a = $("#slbAmount").val(), t = $("#slbTotal").val(), p >= 0 && a >= 0 && (t = p * a), $("#slbTotal").val(t), StopLimitBuyInfo() } function StopLimitBuyUpdate2() { p = $("#slbPrice").val(), a = $("#slbAmount").val(), t = $("#slbTotal").val(), p >= 0 && t >= 0 && (a = t / p), $("#slbAmount").val(a), StopLimitBuyInfo() } function StopLimitBuyInfo() { var t = $("#slbAmount").val(); t > 0 ? t -= t * _bsr : t = 0, $("#slbassamt").html(GetFormatedVal(t, __bf) + " " + __b); var l = _cbt * (_bsr * $("#slbTotal").val()); $("#slbTechnoSavvyV").html(GetFormatedVal(l, __qf) + " " + __q); l = t * $("#slbPrice").val() + l; $("#slbSTV").html(GetFormatedVal(l, __qf) + " " + __q) } function PlaceStopLimitSellOrder() { if (ValidateStopLimitSell()) { var t = BuildStopLimitSellOrderPackage(); $("#slsTotal").val(); $.ajax({ type: "POST", url: "/Order/StopLimitOrderSell", beforeSend: function (t) { t.setRequestHeader("RequestVerificationToken", $('input:hidden[name="__RequestVerificationToken"]').val()) }, data: t, success: function (t) { "true" == t.item1 || 1 == t.item1 ? (StopLimitSellRest(), TupleMsg(t, !0)) : TupleEr(t, !0) }, error: function (t) { console.log(t.statusCode + ":" + t.statusText + ":" + t.responseText) } }), $(this).parent(".input-btn-css").addClass("inputDisabled") } } function ValidateStopLimitSell() { var t = !1; +$("#slsStopPrice").val() <= 0 && ($("#slsStopPriceV").text("Invalid Trigger Price"), $("#slsStopPriceV").removeClass("d-none"), t = !0); var l = $("#slsAmount").val(), e = $("#nbaseavailable").val(); return +l <= 0 || +l > e ? ($("#slsAmountV").text("Invalid Amount"), $("#slsAmountV").removeClass("d-none"), t = !0) : $("#slsAmountV").addClass("d-none"), $("#slsPrice").val() <= 0 ? ($("#slsPriceV").text("Invalid Price"), $("#slsPriceV").removeClass("d-none"), t = !0) : $("#slsPriceV").addClass("d-none"), $("#slsTotal").val() <= 0 ? ($("#slsTotalV").text("Invalid Total"), $("#slsTotalV").removeClass("d-none"), t = !0) : $("#slsTotalV").addClass("d-none"), !t } function BuildStopLimitSellOrderPackage() { var t = $("#slsAmount").val(), l = $("#slsPrice").val(), e = $("#slsStopPrice").val(); return +l > 0 ? { Amount: t, Price: l, side: 1, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, stopPrice: e, OrderId: "?" } : { Amount: t, Price: 0, side: 1, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, stopPrice: e, OrderId: "?" } } function StopLimitSellRest() { $("#slsStopPrice").val(""), $("#slsPrice").val(""), $("#slsAmount").val(""), $("#slsTotal").val(""), $("#slsTechnoSavvyV").val(""), $("#slsSTV").val(""), $("#slsassamt").val(""), $("#slsStopPriceV").addClass("d-none"), $("#slsPriceV").addClass("d-none"), $("#slsAmountV").addClass("d-none"), $("#slsTotalV").addClass("d-none") } function StopLimitSellUpdate1() { "" == $("#slsPrice").val() && $("#slsPrice").val(lastPrice), p = $("#slsPrice").val(), a = $("#slsAmount").val(), t = $("#slsTotal").val(), p >= 0 && a >= 0 && (t = p * a), $("#slsTotal").val(t), StopLimitSellInfo() } function StopLimitSellUpdate2() { $("#slsPrice").val().length <= 0 && lastPrice > 0 && $("#slsPrice").val(lastPrice), p = $("#slsPrice").val(), a = $("#slsAmount").val(), t = $("#slsTotal").val(), p >= 0 && t >= 0 && (a = t / p), $("#slsAmount").val(a), StopLimitSellInfo() } function StopLimitSellInfo() { var t = $("#slsTotal").val(); t > 0 ? t -= t * _asr : t = 0, $("#slsassamt").html(GetFormatedVal(t, __qf) + " " + __q); var l = _cbt * (_asr * $("#slsTotal").val()); $("#slsTechnoSavvyV").html(GetFormatedVal(l, __qf) + " " + __q), $("#slsSTV").html(GetFormatedVal(t + l, __qf) + " " + __q) } function TupleMsg(t, l) { !0 === l && (console.log("Order Status:" + t.item1 + ", Reason:" + t.item2), $(".input-btn-css").removeClass("inputDisabled")) } function TupleEr(t, l) { !0 === l && console.log("Order Status:" + t.item1 + ", Reason:" + t.item2) } $("#slbPrice").keyup(StopLimitBuyUpdate1), $("#slbAmount").focus(StopLimitBuyUpdate1), $("#slbAmount").keyup(StopLimitBuyUpdate1), $("#slbTotal").keyup(StopLimitBuyUpdate2), $("#slbPrice").change(StopLimitBuyUpdate1), $("#slbAmount").change(StopLimitBuyUpdate1), $("#slbTotal").change(StopLimitBuyUpdate2), $("#btnBuyStopLimit").click(PlaceStopLimitBuyOrder), $("#btnBuyStopLimitReset").click(StopLimitBuyRest), StopLimitSellInfo(), StopLimitBuyInfo(), $("#slsPrice").keyup(StopLimitSellUpdate1), $("#slsAmount").keyup(StopLimitSellUpdate1), $("#slsAmount").focus(StopLimitSellUpdate1), $("#slsTotal").keyup(StopLimitSellUpdate2), $("#slsPrice").change(StopLimitSellUpdate1), $("#slsAmount").change(StopLimitSellUpdate1), $("#slsTotal").change(StopLimitSellUpdate2), $("#btnSellStopLimit").click(PlaceStopLimitSellOrder), $("#btnSellStopLimitReset").click(StopLimitSellRest);