function PlaceStopMarketBuyOrder() { if (ValidateStopMarketBuy()) { $("#smbTotal").val(); var e = BuildStopMarketBuyOrderPackage(); $.ajax({ type: "POST", url: "/Order/StopMarketOrderBuy", beforeSend: function (e) { e.setRequestHeader("RequestVerificationToken", $('input:hidden[name="__RequestVerificationToken"]').val()) }, data: e, success: function (e) { "true" == e.item1 ? TupleMsg(e, !0) : TupleEr(e, !0) }, error: function (e) { console.log(e.statusCode + ":" + e.statusText + ":" + e.responseText) } }), $(this).parent(".input-btn-css").addClass("inputDisabled") } } function ValidateStopMarketBuy() { var e = !1; +$("#smbStopPrice").val() <= 0 && ($("#smbStopPriceV").text("Invalid Trigger Price"), $("#smbStopPriceV").removeClass("d-none"), e = !0); var t = $("#smbAmount").val(), a = $("#nquoteavailable").val(); +t <= 0 ? ($("#smbAmountV").text("Invalid Amount"), $("#smbAmountV").removeClass("d-none"), e = !0) : $("#smbAmountV").addClass("d-none"), lastPrice <= 0 ? ($("#smbPriceV").text("Invalid Price"), $("#smbPriceV").removeClass("d-none"), e = !0) : $("#smbPriceV").addClass("d-none"); var s = $("#smbTotal").val(); return s <= 0 || +s > +a ? ($("#smbTotalV").text("Insufficent/Invalid Total"), $("#smbTotalV").removeClass("d-none"), e = !0) : $("#smbTotalV").addClass("d-none"), !e } var mcode = "", bcode = "", qcode = ""; function BuildStopMarketBuyOrderPackage() { var e = $("#smbStopPrice").val(), t = $("#smbAmount").val(), a = lastPrice; return +a > 0 ? { Amount: t, Price: a, side: 0, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, stopPrice: e, OrderId: "?" } : { Amount: t, Price: 0, side: 0, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, stopPrice: e, OrderId: "?" } } function StopMarketBuyRest() { $("#smbStopPrice").val(""), $("#smbAmount").val(""), $("#smbTotal").val(""), $("#smbTechnoSavvyV").val(""), $("#smbSTV").val(""), $("#smbassamt").val(""), $("#smbStopPriceV").addClass("d-none"), $("#smbPriceV").addClass("d-none"), $("#smbAmountV").addClass("d-none"), $("#smbTotalV").addClass("d-none") } function StopMarketBuyUpdate1() { p = lastPrice, a = $("#smbAmount").val(), t = $("#smbTotal").val(), p >= 0 && a >= 0 && (t = p * a), $("#smbTotal").val(t), StopMarketBuyInfo() } function StopMarketBuyUpdate2() { p = lastPrice, a = $("#smbAmount").val(), t = $("#smbTotal").val(), p >= 0 && t >= 0 && (a = t / p), $("#smbAmount").val(a), StopMarketBuyInfo() } function StopMarketBuyInfo() { var e = $("#smbAmount").val(); e > 0 ? e -= e * _bsr : e = 0, $("#smbassamt").html(GetFormatedVal(e, __bf) + " " + __b); var t = _cbt * (_bsr * $("#smbTotal").val()); $("#smbTechnoSavvyV").html(GetFormatedVal(t, __qf) + " " + __q); t = e * $("#smbPrice").val() + t; $("#smbSTV").html(GetFormatedVal(t, __qf) + " " + __q) } function PlaceStopMarketSellOrder() { if (ValidateStopMarketSell()) { var e = BuildStopMarketSellOrderPackage(); $("#smsTotal").val(); $.ajax({ type: "POST", url: "/Order/StopMarketOrderSell", beforeSend: function (e) { e.setRequestHeader("RequestVerificationToken", $('input:hidden[name="__RequestVerificationToken"]').val()) }, data: e, success: function (e) { "true" == e.item1 || 1 == e.item1 ? TupleMsg(e, !0) : TupleEr(e, !0) }, error: function (e) { console.log(e.statusCode + ":" + e.statusText + ":" + e.responseText) } }), $(this).parent(".input-btn-css").addClass("inputDisabled") } } function ValidateStopMarketSell() { var e = !1; +$("#smsStopPrice").val() <= 0 && ($("#smsStopPriceV").text("Invalid Trigger Price"), $("#smsStopPriceV").removeClass("d-none"), e = !0); var t = $("#smsAmount").val(); $("#nbaseavailable").val(); +t <= 0 || _ab < +t ? ($("#smsAmountV").text("Invalid Amount"), $("#smsAmountV").removeClass("d-none"), e = !0) : $("#smsAmountV").addClass("d-none"); var a = lastPrice; return a <= 0 ? ($("#smsPriceV").text("Invalid Price"), $("#smsPriceV").removeClass("d-none"), e = !0) : $("#smsPriceV").addClass("d-none"), $("#smsTotal").val() <= 0 || +t * a <= 0 ? ($("#smsTotalV").text("Invalid Total"), $("#smsTotalV").removeClass("d-none"), e = !0) : $("#smsTotalV").addClass("d-none"), !e } function BuildStopMarketSellOrderPackage() { var e = $("#smsAmount").val(), t = $("#smsStopPrice").val(), a = lastPrice; return +a > 0 ? { Amount: e, Price: a, side: 1, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, stopPrice: t, OrderId: "?" } : { Amount: e, Price: 0, side: 1, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, stopPrice: t, OrderId: "?" } } function StopMarketSellRest() { $("#smsStopPrice").val(""), $("#smsAmount").val(""), $("#smsTotal").val(""), $("#smsTechnoSavvyV").val(""), $("#smsSTV").val(""), $("#smsassamt").val(""), $("#smsStopPriceV").addClass("d-none"), $("#smsPriceV").addClass("d-none"), $("#smsAmountV").addClass("d-none"), $("#smsTotalV").addClass("d-none") } function StopMarketSellUpdate1() { p = lastPrice, a = $("#smsAmount").val(), t = $("#smsTotal").val(), p >= 0 && a >= 0 && (t = p * a), $("#smsTotal").val(t), StopMarketSellInfo() } function StopMarketSellUpdate2() { p = lastPrice, a = $("#smsAmount").val(), t = $("#smsTotal").val(), p >= 0 && t >= 0 && (a = t / p), $("#smsAmount").val(a), StopMarketSellInfo() } function StopMarketSellInfo() { var e = $("#smsTotal").val(); e > 0 ? e -= e * _asr : e = 0, $("#smsassamt").html(GetFormatedVal(e, __qf) + " " + __q); var t = _cbt * (_asr * $("#smsTotal").val()); $("#smsTechnoSavvyV").html(GetFormatedVal(t, __qf) + " " + __q), $("#smsSTV").html(GetFormatedVal(e + t, __qf) + " " + __q) } function TupleMsg(e, t) { !0 === t && (console.log("Order Status:" + e.item1 + ", Reason:" + e.item2), $(".input-btn-css").removeClass("inputDisabled")) } function TupleEr(e, t) { !0 === t && console.log("Order Status:" + e.item1 + ", Reason:" + e.item2) } $("#smbPrice").keyup(StopMarketBuyUpdate1), $("#smbAmount").keyup(StopMarketBuyUpdate1), $("#smbTotal").keyup(StopMarketBuyUpdate2), $("#smbPrice").change(StopMarketBuyUpdate1), $("#smbAmount").change(StopMarketBuyUpdate1), $("#smbTotal").change(StopMarketBuyUpdate2), $("#btnBuyStopMarket").click(PlaceStopMarketBuyOrder), $("#btnBuyStopMarketReset").click(StopMarketBuyRest), StopMarketBuyInfo(), StopMarketSellInfo(), $("#smsPrice").prop("disabled", !0), $("#smbPrice").prop("disabled", !0), $("#smsAmount").keyup(StopMarketSellUpdate1), $("#smsTotal").keyup(StopMarketSellUpdate2), $("#smsAmount").change(StopMarketSellUpdate1), $("#smsTotal").change(StopMarketSellUpdate2), $("#btnSellStopMarket").click(PlaceStopMarketSellOrder), $("#btnSellStopMarketReset").click(StopMarketSellRest);