function LoadOpenOrders() { if (null == myOpenOrders || null == myOpenOrders) return $("#tbopenorder").html(a), $("#walletOpenOrderTable").paging({ limit: 10 }), void $(".paging-nav a:nth-child(2)").addClass("selected-page"); for (var e = myOpenOrders, a = "", t = e.length, r = 0; r < t; r++) { var n = e[r]; a += '<tr data-pair="' + n.MarketCode.toLowerCase() + '" data-type="' + n.OrderTypeT + '" data-side="' + n.OrderSideT + '">', a += '    <td class="td-sticky-left">' + n.MarketName + "</td>", a += '   <td><div class="datettrade44">', a += "        <span> " + new moment.utc(n.PlacedOn).local().format("LL") + " </span> <span> <small> " + new moment.utc(n.PlacedOn).local().format("LTS") + "</small></span></div> </td>", a += '   <td> <span class="d-inline-block opencss11" tabindex="0" data-bs-toggle="popover" data-bs-trigger="hover focus" data-bs-content="' + n.InternalOrderID + '" data-bs-original-title="" title="">' + n.InternalOrderID.split("-")[0].toUpperCase() + "..</span>  </td>", a += "    <td>" + n.OrderTypeT + "</td>", "Buy" == n.OrderSide ? a += '   <td><span class="basegreen">' + n.OrderSideT + "</span> </td>" : a += '   <td><span class="basered">' + n.OrderSideT + "</span> </td>", a += '<td><div class="datettrade44"><span> ' + GetFormatedVal(n.Price, _fsl) + "</span> <small> " + n.QuoteTokenCodeName + " </small></div></td>", a += '<td><div class="datettrade44"><span> ' + GetFormatedVal(n.OriginalVolume, _fsl) + "</span> <small> " + n.BaseTokenCodeName + " </small></div></td>", a += '<td><div class="datettrade44"><span> ' + GetFormatedVal(n.CurrentVolume, _fsl) + "</span> <small> " + n.BaseTokenCodeName + " </small></div></td>", a += '<td><div class="datettrade44"><span> ' + GetFormatedVal(n.CurrentVolume * n.Price, _fsl) + "</span> <small> " + n.QuoteTokenCodeName + " </small></div></td>", a += "    <td>N/A </td>", a += '<td><div class="datettrade44"><span> ' + n._OrderSwapTradeValue + "</span> <small> " + n.QuoteTokenCodeName + " </small></div></td>", n._OrderTrigger > 0 ? a += "    <td>" + n._OrderTrigger + " </td>" : a += "    <td>N/A </td>", a += '   <td class="csscancel44"><a class="btnFetch" href="javascript:cancelOrder(\'' + n.MarketCode + "','" + n.InternalOrderID + "')\"> Cancel </a></td>    </tr>" } $("#tbopenorder").html(a), cancelingBtn(), $("#openOrderTableMain").simplePagination({ items_per_page: 10 }), ApplySearch(), sortTableOrder() } function cancelOrder(e, a) { var t = { mcode: e, id: a }; $.ajax({ type: "POST", url: "/Trade/CancelMyOrder", data: t, success: function (e) { e && ($(".btnFetch").prop("disabled", !1), $(".btnFetch").html("Cancel"), window.location.reload()) }, error: function (e) { console.log(e.statusCode + ":" + e.statusText + ":" + e.responseText), alert("delete request failed..") } }) } function cancelingBtn() { $(".btnFetch").on("click", (function () { $(this).prop("disabled", !0), $(this).html('<i class="fa fa-circle-o-notch fa-spin"></i> Canceling...') })) } function ApplySearch() { $("table tfoot").hide(), $(".market-search").each((function () { var e = $(this).attr("data-tab"); $(this).on("keyup", (function () { var a = $(this).val().replace(/\s/g, "").toLowerCase(), t = "#" + e + " tr", r = $("#" + e), n = $(t).filter((function () { return $(this).text().toLowerCase().indexOf(a) > -1 })); n.length > 0 ? ($(r).nextAll("tfoot").hide(), $(".my-navigation").show()) : ($(r).nextAll("tfoot").show(), $(".my-navigation").hide(), $(r).parent().parent().children(".trasaction-table").hide()), $(t).hide(), n.show() })), $(".market-search").on("search", (function () { $(".market-search").val(""), $(".market-search").trigger("keyup") })) })) } function orderNotFound() { $("#walletOpenOrderTable tfoot").hide(), 0 == myOpenOrders.length ? setInterval((function () { $("#tbopenorder").hide(), $("#walletOpenOrderTable tfoot").show() }), 3e3) : LoadOpenOrders() } orderNotFound(); var Pair = [], Side = [], OrderType = []; function filterOrders() { var e = myOpenOrders; if (console.log("data open", e), 0 == e.length && $(".my-select2").chosen({ width: "100%" }), e.length <= 0) return; e.forEach((function (e) { jQuery.inArray(e.MarketCode, Pair) <= -1 && Pair.push(e.MarketCode), jQuery.inArray(e.OrderSide, Side) <= -1 && Side.push(e.OrderSide), jQuery.inArray(e.OrderType, OrderType) <= -1 && OrderType.push(e.OrderType) })); let a = Pair.filter(((e, a, t) => t.indexOf(e) === a)); console.log("uniqueArray", a); let t = Side.filter(((e, a, t) => t.indexOf(e) === a)); console.log("uniqueArray", t); let r = OrderType.filter(((e, a, t) => t.indexOf(e) === a)); console.log("uniqueArray", r); for (var n = Pair.length, d = "", i = 0; i < n; i++) { var o = Pair[i]; 0 != i && null != o || (d += '<option value="" selected>All</option>'), d += '<option value="' + o + '">' + o + "</option>" } $("#fPair").html(d), $("#fPair").chosen({ width: "100%" }); var l = Side.length, s = ""; for (i = 0; i < l; i++) { var p = Side[i]; 0 == i && (s += '<option value="" selected>All</option>'), s += '<option value="' + p + '">' + p + "</option>" } $("#fSide").html(s); var c = OrderType.length, h = ""; for (i = 0; i < c; i++) { var f = OrderType[i]; 0 == i && (h += '<option value="" selected>All</option>'), h += '<option value="' + f + '">' + f + "</option>" } $("#fOrderType").html(h), $("#fOrderType").chosen({ width: "100%" }), filterData(), LoadOrdersHist() } function filterData() { $("#fPair").on("change", (function (e) { var a = e.target.value.toLowerCase(); console.log("location", a); var t = $("#tbTrades-Main table tbody"); a.length ? (t.find('tr[data-pair!="' + a + '"]').hide(), t.find('tr[data-pair="' + a + '"]').show(), $(".my-navigation").hide()) : (t.find("tr").show(), $("#tbTrades-Main").simplePagination({ items_per_page: 10 }), a.length, $(".my-navigation").show()) })), $("#fSide").on("change", (function (e) { var a = e.target.value, t = $("#tbTrades-Main table tbody"); a.length ? (t.find('tr[data-side!="' + a + '"]').hide(), t.find('tr[data-side="' + a + '"]').show(), $(".my-navigation").hide()) : (t.find("tr").show(), $("#tbTrades-Main").simplePagination({ items_per_page: 10 }), a.length, $(".my-navigation").show()) })), $("#fOrderType").on("change", (function (e) { var a = e.target.value, t = $("#tbTrades-Main table tbody"); a.length ? (t.find('tr[data-type!="' + a + '"]').hide(), t.find('tr[data-type="' + a + '"]').show(), $(".my-navigation").hide()) : (t.find("tr").show(), $("#tbTrades-Main").simplePagination({ items_per_page: 10 }), a.length, $(".my-navigation").show()) })), $("#fPeriod").on("change", (function (e) { var a = e.target.value, t = $("#tbTrades-Main table tbody"); a.length ? (t.find('tr[data-days!="' + a + '"]').hide(), t.find('tr[data-days="' + a + '"]').show(), $(".my-navigation").hide()) : (t.find("tr").show(), $("#tbTrades-Main").simplePagination({ items_per_page: 10 }), a.length, $(".my-navigation").show()) })) }