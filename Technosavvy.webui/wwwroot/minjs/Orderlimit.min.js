var rn = 5; function PlaceLimitBuyOrder() { if (ValidateLimitBuy()) { $("#lbTotal").val(); var l = BuildLimitBuyOrderPackage(); $.ajax({ type: "POST", url: "/Order/LimitOrderBuy", beforeSend: function (l) { l.setRequestHeader("RequestVerificationToken", $('input:hidden[name="__RequestVerificationToken"]').val()) }, data: l, success: function (l) { "true" == l.item1 ? (LimitBuyRest(), TupleMsg(l, !0)) : TupleEr(l, !0) }, error: function (l) { console.log(l.statusCode + ":" + l.statusText + ":" + l.responseText), alert("danger") } }), $(this).parent(".input-btn-css").addClass("inputDisabled") } } function UpdateQuoteQty(l) { var e = $("#nquoteavailable").val(); return e = +e + l, $("#mbqa").text(e), $("#nquoteavailable").val(e), _qa = e, e } function UpdateBaseQty(l) { var e = $("#nbaseavailable").val(); return e = +e + l, $("#lsba").text(e), $("#nbaseavailable").val(e), _ba = e, e } function ValidateLimitBuy() { var l = !1, e = $("#lbAmount").val(), a = $("#nquoteavailable").val(); +e <= 0 ? ($("#lbAmountV").text("Invalid Amount"), $("#lbAmountV").removeClass("d-none"), l = !0) : $("#lbAmountV").addClass("d-none"), $("#lbPrice").val() <= 0 ? ($("#lbPriceV").text("Invalid Price"), $("#lbPriceV").removeClass("d-none"), l = !0) : $("#lbPriceV").addClass("d-none"); var t = $("#lbTotal").val(); return t <= 0 || +t > +a ? ($("#lbTotalV").text("Insufficent/Invalid Total"), $("#lbTotalV").removeClass("d-none"), l = !0) : $("#lbTotalV").addClass("d-none"), !l } var mcode = "", bcode = "", qcode = ""; function BuildLimitBuyOrderPackage() { var l = $("#lbAmount").val(), e = $("#lbPrice").val(); return +e > 0 ? { Amount: l, Price: e, side: 0, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, OrderId: "?" } : { Amount: l, Price: 0, side: 0, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, OrderId: "?" } } function LimitBuyRest() { $("#lbPrice").val(""), $("#lbAmount").val(""), $("#lbTotal").val(""), $("#lbTechnoSavvyV").val(""), $("#lbSTV").val(""), $("#lbassamt").val(""), $("#lbPriceV").addClass("d-none"), $("#lbAmountV").addClass("d-none"), $("#lbTotalV").addClass("d-none") } function LimitBuyUpdate1() { "" == $("#lbPrice").val() && $("#lbPrice").val(lastPrice), p = $("#lbPrice").val(), a = $("#lbAmount").val(), t = $("#lbTotal").val(), p >= 0 && a >= 0 && (t = p * a), $("#lbTotal").val(t), LimitBuyInfo() } function LimitBuyUpdate2() { p = $("#lbPrice").val(), a = $("#lbAmount").val(), t = $("#lbTotal").val(), p >= 0 && t >= 0 && (a = t / p), $("#lbAmount").val(a), LimitBuyInfo() } function LimitBuyInfo() { var l = $("#lbAmount").val(); l > 0 ? l -= l * _bsr : l = 0, $("#lbassamt").html(GetFormatedVal(l, __bf) + " " + __b); var e = _cbt * (_bsr * $("#lbTotal").val()); $("#lbTechnoSavvyV").html(GetFormatedVal(e, __qf) + " " + __q); e = l * $("#lbPrice").val() + e; $("#lbSTV").html(GetFormatedVal(e, __qf) + " " + __q) } function PlaceLimitSellOrder() { if (ValidateLimitSell()) { var l = BuildLimitSellOrderPackage(); $("#lsTotal").val(); $.ajax({ type: "POST", url: "/Order/LimitOrderSell", beforeSend: function (l) { l.setRequestHeader("RequestVerificationToken", $('input:hidden[name="__RequestVerificationToken"]').val()) }, data: l, success: function (l) { "true" == l.item1 || 1 == l.item1 ? (LimitSellRest(), TupleMsg(l, !0)) : TupleEr(l, !0) }, error: function (l) { console.log(l.statusCode + ":" + l.statusText + ":" + l.responseText) } }), $(this).parent(".input-btn-css").addClass("inputDisabled") } } function ValidateLimitSell() { var l = !1, e = $("#lsAmount").val(), a = $("#nbaseavailable").val(); return +e <= 0 || +e > a ? ($("#lsAmountV").text("Invalid Amount"), $("#lsAmountV").removeClass("d-none"), l = !0) : $("#lsAmountV").addClass("d-none"), $("#lsPrice").val() <= 0 ? ($("#lsPriceV").text("Invalid Price"), $("#lsPriceV").removeClass("d-none"), l = !0) : $("#lsPriceV").addClass("d-none"), $("#lsTotal").val() <= 0 ? ($("#lsTotalV").text("Invalid Total"), $("#lsTotalV").removeClass("d-none"), l = !0) : $("#lsTotalV").addClass("d-none"), !l } function BuildLimitSellOrderPackage() { var l = $("#lsAmount").val(), e = $("#lsPrice").val(); return +e > 0 ? { Amount: l, Price: e, side: 1, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, OrderId: "?" } : { Amount: l, Price: 0, side: 1, mCode: __mCode, quoteCode: __q, qTag: _qTag, baseCode: __b, bTag: _bTag, OrderId: "?" } } function LimitSellRest() { $("#lsPrice").val(""), $("#lsAmount").val(""), $("#lsTotal").val(""), $("#lsTechnoSavvyV").val(""), $("#lsSTV").val(""), $("#lsassamt").val(""), $("#lsPriceV").addClass("d-none"), $("#lsAmountV").addClass("d-none"), $("#lsTotalV").addClass("d-none") } function LimitSellUpdate1() { "" == $("#lsPrice").val() && $("#lsPrice").val(lastPrice), p = $("#lsPrice").val(), a = $("#lsAmount").val(), t = $("#lsTotal").val(), p >= 0 && a >= 0 && (t = p * a), $("#lsTotal").val(t), LimitSellInfo() } function LimitSellUpdate2() { $("#lsPrice").val().length <= 0 && lastPrice > 0 && $("#lsPrice").val(lastPrice), p = $("#lsPrice").val(), a = $("#lsAmount").val(), t = $("#lsTotal").val(), p >= 0 && t >= 0 && (a = t / p), $("#lsAmount").val(a), LimitSellInfo() } function LimitSellInfo() { var l = $("#lsTotal").val(); l > 0 ? l -= l * _asr : l = 0, $("#lsassamt").html(GetFormatedVal(l, __qf) + " " + __q); var e = _cbt * (_asr * $("#lsTotal").val()); $("#lsTechnoSavvyV").html(GetFormatedVal(e, __qf) + " " + __q), $("#lsSTV").html(GetFormatedVal(l + e, __qf) + " " + __q) } function TupleMsg(l, e) { !0 === e && console.log("Order Status:" + l.item1 + ", Reason:" + l.item2), $(".input-btn-css").removeClass("inputDisabled") } function TupleEr(l, e) { !0 === e && console.log("Order Status:" + l.item1 + ", Reason:" + l.item2) } $("#lbPrice").keyup(LimitBuyUpdate1), $("#lbAmount").focus(LimitBuyUpdate1), $("#lbAmount").keyup(LimitBuyUpdate1), $("#lbTotal").keyup(LimitBuyUpdate2), $("#lbPrice").change(LimitBuyUpdate1), $("#lbAmount").change(LimitBuyUpdate1), $("#lbTotal").change(LimitBuyUpdate2), $("#btnBuyLimit").click(PlaceLimitBuyOrder), $("#btnBuyLimitReset").click(LimitBuyRest), LimitSellInfo(), LimitBuyInfo(), $("#lsPrice").keyup(LimitSellUpdate1), $("#lsAmount").keyup(LimitSellUpdate1), $("#lsAmount").focus(LimitSellUpdate1), $("#lsTotal").keyup(LimitSellUpdate2), $("#lsPrice").change(LimitSellUpdate1), $("#lsAmount").change(LimitSellUpdate1), $("#lsTotal").change(LimitSellUpdate2), $("#btnSellLimit").click(PlaceLimitSellOrder), $("#btnSellLimitReset").click(LimitSellRest);